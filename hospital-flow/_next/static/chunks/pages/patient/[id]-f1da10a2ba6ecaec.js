(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[561],{2779:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/patient/[id]",function(){return s(2354)}])},2600:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var n=s(5893);function i(e){let{citation:t,sectionId:s,onNoteClick:i}=e;return(0,n.jsxs)("blockquote",{className:"border-l-4 border-blue-500 pl-4 italic cursor-pointer bg-white rounded-r-lg transition-all duration-200 hover:shadow-md mt-4",onClick:()=>{console.log("Citation clicked:",{noteId:t.note_id,sectionId:s,quote:t.quote}),null==i||i(t.note_id,s,t.quote)},children:[(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["“",t.quote,"”"]}),(0,n.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[(0,n.jsx)("span",{className:"font-medium",children:"Source:"})," Note ",t.note_id]})]})}},3427:function(e,t,s){"use strict";s.d(t,{r:function(){return r}});var n=s(5893),i=s(2457),a=s(2600);function r(e){let{housing:t,onNoteClick:s,isExpanded:r,onToggleExpand:o}=e,l=(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})});return(0,n.jsxs)(i.e,{icon:l,title:t.current_living_arrangement?"Current Living Arrangement: ".concat(t.current_living_arrangement):"Housing Situation",isExpanded:r,onToggleExpand:o,color:"green",children:[t.past_living_arrangement&&(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Past Living Arrangement"}),(0,n.jsx)("p",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg",children:t.past_living_arrangement})]}),t.summary&&(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Summary"}),(0,n.jsx)("p",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg",children:t.summary})]}),t.citations.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Evidence"}),t.citations.map((e,t)=>(0,n.jsx)(a.I,{citation:e,sectionId:"housing-section",onNoteClick:s},t))]})]})}},117:function(e,t,s){"use strict";var n=s(5893);s(7294),t.Z=()=>(0,n.jsx)("div",{className:"fixed inset-0 bg-gray-100 bg-opacity-75 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("h2",{className:"mt-4 text-xl font-semibold text-gray-700",children:"Generating Summary..."}),(0,n.jsx)("p",{className:"mt-2 text-gray-500",children:"Please wait while we analyze the patient notes."})]})})},579:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var n=s(5893),i=s(1163),a=s(7294);function r(e){let{currentPatientId:t}=e,[s,r]=(0,a.useState)([]),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),m=(0,i.useRouter)();(0,a.useEffect)(()=>{(async()=>{d(!0);try{let e=await fetch("/hospital-flow/patient_discharge.json");if(!e.ok)throw Error("Failed to load static data");let t=(await e.json()).map(e=>({pat_id_surrogate:e.pat_id_surrogate,enc_date:e.enc_date}));r(t),l(null)}catch(e){l(e instanceof Error?e.message:"An error occurred loading patient data")}finally{d(!1)}})()},[]);let x=e=>{let t=new Date(e.enc_date),s=encodeURIComponent("".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0"),"-").concat(String(t.getUTCHours()).padStart(2,"0"),":").concat(String(t.getUTCMinutes()).padStart(2,"0"),":").concat(String(t.getUTCSeconds()).padStart(2,"0")));m.push("/patient/".concat(e.pat_id_surrogate,"?timestamp=").concat(s))};return o?(0,n.jsx)("div",{className:"w-64 bg-red-50 border-r border-red-200 p-4",children:(0,n.jsxs)("div",{className:"text-red-800",children:[(0,n.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Error loading patients"}),(0,n.jsx)("p",{className:"text-xs",children:o})]})}):(0,n.jsxs)("div",{className:"w-64 bg-gray-50 border-r border-gray-200 flex flex-col h-screen",children:[(0,n.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Patients"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:c?"Loading...":"".concat(s.length," patients available")})]}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto",children:c?(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)("div",{className:"animate-pulse space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsx)("div",{className:"h-10 bg-gray-200 rounded"},t))})}):(0,n.jsxs)("div",{className:"py-2",children:[s.map(e=>(0,n.jsx)("button",{onClick:()=>x(e),className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-100 transition-colors duration-150 border-l-4 ".concat(t===e.pat_id_surrogate.toString()?"bg-blue-50 border-blue-500 text-blue-900 font-medium":"border-transparent text-gray-700"),children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("span",{children:["Patient ",e.pat_id_surrogate]}),t===e.pat_id_surrogate.toString()&&(0,n.jsx)("svg",{className:"h-4 w-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},"".concat(e.pat_id_surrogate,"-").concat(e.enc_date))),0===s.length&&!c&&(0,n.jsx)("div",{className:"px-4 py-8 text-center",children:(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"No patients available"})})]})})]})}},2457:function(e,t,s){"use strict";s.d(t,{e:function(){return i}});var n=s(5893);function i(e){let{icon:t,title:s,isExpanded:i,onToggleExpand:a,children:r,color:o="blue"}=e;return(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[(0,n.jsx)("div",{className:"bg-gradient-to-r ".concat("from-".concat(o,"-50")," to-white p-6 border-b cursor-pointer transition-colors duration-200 ").concat(i?"":"hover:bg-".concat(o,"-50")),onClick:a,children:(0,n.jsxs)("div",{className:"flex items-start gap-4",children:[(0,n.jsx)("div",{className:"flex-shrink-0 w-8 h-8 ".concat("bg-".concat(o,"-100")," rounded-full flex items-center justify-center"),children:(0,n.jsx)("span",{className:"text-".concat(o,"-600"),children:t})}),(0,n.jsx)("div",{className:"flex-grow",children:(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:s}),(0,n.jsx)("button",{className:"ml-4 text-gray-400 hover:text-gray-600 focus:outline-none transition-transform duration-200",style:{transform:i?"rotate(180deg)":"rotate(0deg)"},children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})})]})}),i&&(0,n.jsx)("div",{className:"p-6",children:r})]})}},3596:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var n=s(5893),i=s(1664),a=s.n(i),r=s(1163);function o(e){let{className:t=""}=e,s=(0,r.useRouter)(),i=s.pathname.startsWith("/patient")||"/"===s.pathname,o="/hospital-discharge"===s.pathname;return(0,n.jsx)("nav",{className:"bg-white border-b border-gray-200 ".concat(t),children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,n.jsxs)("div",{className:"flex space-x-8",children:[(0,n.jsx)(a(),{href:"/",className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ".concat(i?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Patient Discharge Needs"}),(0,n.jsx)(a(),{href:"/hospital-discharge",className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ".concat(o?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Hospital Flow"})]})})})}},2354:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return q}});var n,i,a,r,o,l,c,d,m,x,h,u,g,p,f,j,v=s(5893),b=s(9008),N=s.n(b),y=s(1163),_=s(7294);let w=e=>new TextDecoder("utf-8").decode(new TextEncoder().encode(e)).replace(/[\x00-\x1F\x7F-\x9F]/g," ").replace(/[ \t]{4,}/g,"\n\n").replace(/ +\n/g,"\n").trim();function k(e){let{note:t,maxHeight:s=500,isHighlighted:n,highlightedQuote:i}=e,[a,r]=(0,_.useState)(!0),[o,l]=(0,_.useState)(!1),c=(0,_.useRef)(null),[d,m]=(0,_.useState)(null);return(0,_.useEffect)(()=>{n&&r(!0)},[n,i,t.note_id]),(0,_.useEffect)(()=>{if(c.current){let e=c.current.scrollHeight>s;l(e),r(!e)}},[s,t.note_text]),(0,_.useEffect)(()=>{if(d){let e=setTimeout(()=>{m(null)},3e3);return()=>clearTimeout(e)}},[d]),(0,v.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 transition-colors duration-500 ".concat(n?"bg-yellow-50":""),"data-note-id":t.note_id,children:(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsxs)("div",{className:"flex justify-between items-start",children:[(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,v.jsx)("h3",{className:"text-xl font-semibold",children:t.type}),(0,v.jsxs)("span",{className:"text-sm text-gray-500",children:["(ID: ",t.note_id,")"]})]}),(0,v.jsx)("div",{className:"text-sm text-gray-600",children:t.clinical_service})]}),(0,v.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,v.jsxs)("div",{className:"text-sm text-gray-500",children:["Note Date: ",new Date(t.timestamp).toLocaleString()]}),o&&(0,v.jsx)("button",{onClick:()=>{a&&c.current&&(c.current.scrollTop=0),r(!a)},className:"text-blue-500 hover:text-blue-600 text-sm font-medium focus:outline-none whitespace-nowrap",children:a?"Show Less":"Show More"})]})]}),(0,v.jsxs)("div",{ref:c,className:"text-gray-600 relative ".concat(!o||a?"":"overflow-hidden"),style:{maxHeight:!o||a?void 0:"".concat(s,"px")},children:[(0,v.jsx)("div",{className:"whitespace-pre-wrap",children:(e=>{if(!i)return e;try{let t=i.replace(/\s+/g," ").trim().split(" ").map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("\\s+"),s=RegExp(t,"i"),n=e.match(s);if(!n||!n[0])return(0,v.jsx)("span",{className:"bg-yellow-200 transition-colors duration-500",children:e});{let t=e.toLowerCase().indexOf(n[0].toLowerCase());if(-1!==t){let s=e.slice(0,t),i=e.slice(t,t+n[0].length),a=e.slice(t+n[0].length);return(0,v.jsxs)(v.Fragment,{children:[s,(0,v.jsx)("span",{className:"bg-yellow-300 font-bold border-2 border-yellow-500 px-1 rounded transition-colors duration-500",style:{backgroundColor:"#fef08a",border:"2px solid #eab308"},children:i}),a]})}}return e}catch(t){return console.error("Error highlighting text with flexible whitespace:",t),e}})(w(t.note_text))}),!a&&o&&(0,v.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-20 bg-gradient-to-t from-white to-transparent"})]})]})})}var S=s(117),C=s(579),E=s(5675),L=s.n(E),I=s(2457),T=s(2600);function M(e){let{need:t,index:s,onNoteClick:n,isExpanded:i,onToggleExpand:a}=e,r="need-".concat(s),o=t.current_actions.length>0,l=t.planned_actions.length>0,c=o?"active":l?"pending":"completed",d=(0,v.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,v.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h8"})]});return(0,v.jsxs)(I.e,{icon:d,title:t.description,isExpanded:i,onToggleExpand:a,color:"blue",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,v.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",completed:"bg-gray-100 text-gray-800"}[c]),children:{active:"Active",pending:"Pending",completed:"Completed"}[c]}),t.priority&&(0,v.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[t.priority.charAt(0).toUpperCase()+t.priority.slice(1)," Priority"]})]}),(0,v.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-2",children:[t.previous_actions.length>0&&(0,v.jsxs)("span",{className:"flex items-center gap-1",children:[(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.previous_actions.length," Previous"]}),t.current_actions.length>0&&(0,v.jsxs)("span",{className:"flex items-center gap-1",children:[(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.current_actions.length," Current"]}),t.planned_actions.length>0&&(0,v.jsxs)("span",{className:"flex items-center gap-1",children:[(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),t.planned_actions.length," Planned"]})]}),t.citation&&(0,v.jsx)(T.I,{citation:t.citation,sectionId:r,onNoteClick:n}),(0,v.jsxs)("div",{className:"mt-4",children:[t.previous_actions.length>0&&(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Previous Actions"}),t.previous_actions.map((e,t)=>(0,v.jsxs)("div",{className:"mb-2",children:[(0,v.jsx)("p",{className:"text-gray-700 text-sm",children:e.description}),(0,v.jsx)(T.I,{citation:e.citation,sectionId:"".concat(r,"-previous"),onNoteClick:n})]},t))]}),t.current_actions.length>0&&(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Current Actions"}),t.current_actions.map((e,t)=>(0,v.jsxs)("div",{className:"mb-2",children:[(0,v.jsx)("p",{className:"text-gray-700 text-sm",children:e.description}),(0,v.jsx)(T.I,{citation:e.citation,sectionId:"".concat(r,"-current"),onNoteClick:n})]},t))]}),t.planned_actions.length>0&&(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Planned Actions"}),t.planned_actions.map((e,t)=>(0,v.jsxs)("div",{className:"mb-2",children:[(0,v.jsx)("p",{className:"text-gray-700 text-sm",children:e.description}),(0,v.jsx)(T.I,{citation:e.citation,sectionId:"".concat(r,"-planned"),onNoteClick:n})]},t))]})]})]})}var O=s(3427);function H(e){let{admission:t,onNoteClick:s,isExpanded:n,onToggleExpand:i}=e,a=(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})});return t.reason&&(0,v.jsx)(I.e,{icon:a,title:t.reason,isExpanded:n,onToggleExpand:i,color:"amber",children:t.citation&&(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Evidence"}),(0,v.jsx)(T.I,{citation:t.citation,sectionId:"admission-section",onNoteClick:s})]})})}function R(e){let{oneLiner:t,onNoteClick:s,isExpanded:n,onToggleExpand:i}=e,a=(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});return t.summary&&(0,v.jsx)(I.e,{icon:a,title:t.summary,isExpanded:n,onToggleExpand:i,color:"blue",children:t.citation&&(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Evidence"}),(0,v.jsx)(T.I,{citation:t.citation,sectionId:"one-liner-section",onNoteClick:s})]})})}function A(e){let{discharge:t,onNoteClick:s,isExpanded:n,onToggleExpand:i}=e,a=(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})});return t.summary&&(0,v.jsxs)(I.e,{icon:a,title:t.summary,isExpanded:n,onToggleExpand:i,color:"green",children:[t.details&&(0,v.jsxs)("div",{className:"mb-6",children:[(0,v.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Summary"}),(0,v.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,v.jsx)("p",{className:"text-gray-600 leading-relaxed text-base",children:t.details})})]}),t.citation&&(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Evidence"}),(0,v.jsx)(T.I,{citation:t.citation,sectionId:"discharge-section",onNoteClick:s})]})]})}function P(e){let{contacts:t,onNoteClick:s,isExpanded:n,onToggleExpand:i}=e,a=(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})});return(0,v.jsx)(I.e,{icon:a,title:"Patient Contacts",isExpanded:n,onToggleExpand:i,color:"indigo",children:0===t.length?(0,v.jsx)("p",{className:"text-gray-500 italic",children:"No contact information available."}):(0,v.jsx)("div",{className:"space-y-6",children:t.map((e,t)=>(0,v.jsxs)("div",{className:"border-b border-gray-100 pb-4 last:border-0 last:pb-0",children:[(0,v.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,v.jsx)("span",{className:"w-5 h-5 flex-shrink-0 rounded-full bg-indigo-100 flex items-center justify-center",children:(0,v.jsx)("span",{className:"text-xs text-indigo-600 font-medium",children:t+1})}),(0,v.jsx)("h4",{className:"font-medium text-gray-800",children:e.name})]}),(0,v.jsxs)("div",{className:"space-y-2 pl-7",children:[e.relation&&(0,v.jsxs)("div",{className:"flex items-start gap-2",children:[(0,v.jsx)("span",{className:"text-gray-500 font-medium w-24 flex-shrink-0",children:"Relation:"}),(0,v.jsx)("span",{className:"text-gray-700",children:e.relation})]}),e.contact_info&&(0,v.jsxs)("div",{className:"flex items-start gap-2",children:[(0,v.jsx)("span",{className:"text-gray-500 font-medium w-24 flex-shrink-0",children:"Contact Info:"}),(0,v.jsx)("span",{className:"text-gray-700",children:e.contact_info})]}),(0,v.jsx)("div",{className:"mt-2",children:(0,v.jsx)(T.I,{citation:e.citation,sectionId:"".concat("patient-contacts-section","-contact-").concat(t),onNoteClick:s})})]})]},t))})})}function U(e){let{substanceUse:t,onNoteClick:s,isExpanded:n,onToggleExpand:i}=e,a=(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})});return t.summary&&(0,v.jsxs)(I.e,{icon:a,title:t.summary,isExpanded:n,onToggleExpand:i,color:"amber",children:[t.date_of_last_use&&(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Last Use"}),(0,v.jsx)("p",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg",children:t.date_of_last_use})]}),t.on_methadone&&(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Methadone Treatment"}),(0,v.jsx)("p",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg",children:t.on_methadone})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Evidence"}),(0,v.jsx)(T.I,{citation:t.citation,sectionId:"substance-use-section",onNoteClick:s})]})]})}function B(e){let{condition:t,onNoteClick:s,isExpanded:n,onToggleExpand:i,index:a}=e,r=(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})});return(0,v.jsxs)(I.e,{icon:r,title:t.diagnosis,isExpanded:n,onToggleExpand:i,color:"red",children:[t.date_of_diagonsis&&(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Date of Diagnosis"}),(0,v.jsx)("p",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg",children:t.date_of_diagonsis})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Evidence"}),(0,v.jsx)(T.I,{citation:t.citation,sectionId:void 0!==a?"severe-med-cond-".concat(a):"severe-med-cond-section",onNoteClick:s})]})]})}function V(e){let{conditions:t,onNoteClick:s}=e,[n,i]=(0,_.useState)({}),[a,r]=(0,_.useState)(!1),o=e=>{i(s=>{let n={...s,[e]:!s[e]};return r(Object.values(n).every(e=>e)&&Object.keys(n).length===t.length),n})};return t.length?(0,v.jsxs)("div",{className:"mb-8","data-section-id":"severe-med-cond",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Medical Conditions"}),t.length>1&&(0,v.jsxs)("button",{onClick:()=>{let e=!a;r(e),i(t.reduce((t,s,n)=>(t[n]=e,t),{}))},className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200",children:[(0,v.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform duration-200 ".concat(a?"transform rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),a?"Collapse All":"Expand All"]})]}),(0,v.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>(0,v.jsx)("div",{"data-section-id":"severe-med-cond-".concat(t),children:(0,v.jsx)(B,{condition:e,onNoteClick:s,isExpanded:n[t]||!1,onToggleExpand:()=>o(t),index:t})},t))})]}):null}function W(e){let{device:t,onNoteClick:s,isExpanded:n,onToggleExpand:i,index:a}=e,r=(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})});return(0,v.jsxs)(I.e,{icon:r,title:t.device_type,isExpanded:n,onToggleExpand:i,color:"indigo",children:[(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Summary"}),(0,v.jsx)("p",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg",children:t.summary})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Evidence"}),(0,v.jsx)(T.I,{citation:t.citation,sectionId:void 0!==a?"dme-device-".concat(a):"dme-section",onNoteClick:s})]})]})}(n=m||(m={})).YES="yes",n.NO="no",(i=x||(x={})).COMPLETED="completed",i.IN_PROGRESS="in_progress",i.PLANNED="planned",(a=h||(h={})).RESOLVED="resolved",a.ONGOING="ongoing",a.NEW="new",(r=u||(u={})).HIGH="high",r.MEDIUM="medium",r.LOW="low",(o=g||(g={})).REHAB="rehab",o.SPEECH="speech",o.NUTRITION="nutrition",o.LANGUAGE="language",(l=p||(p={})).UNKNOWN="unknown",l.PAST="past",l.CURRENT="current",l.NO_USE="no use",(c=f||(f={})).RENT_OR_OWN="Rent or Own",c.RENT_WITH_SUPPORT="Rent Unit with Support Services Onsite",c.JAIL_HOMELESS="Residential Treatment / Jail - will exit homeless",c.LIVING_OUTSIDE="Living Outside (Street / Vehicle / Makeshift)",c.TEMP="Temporarily with Friend / Family",c.STABIL_ROOM="Stabilization Room / Hotel / SRO",c.SHELTER="Shelter / Navigation Center",c.SUPPORTIVE_HOUSING="Permanent Supportive Housing",c.JAIL_HOUSED="Residential Treatment / Jail - will exit housed",c.UNKNOWN="Unknown",(d=j||(j={})).INTERPERSONAL_VIOLENCE="interpersonal violence",d.TOBACCO_USE="tobacco use",d.HOUSING="housing",d.IMMIGRATION="immigration",d.FOOD_INSECURITY="food_insecurity",d.SUBSTANCE_USE="substance use",d.ALOCHOL_USE="alcohol use",d.MENTAL_HEALTH="mental health";let D=e=>{let{needs:t,activeNeedId:s,onNeedClick:n,hasHousing:i,hasConsult:a,hasTherapy:r,hasReason:o,hasOneLiner:l,hasDischarge:c,hasDx:d,hasContacts:m,hasSupportAtHome:x,hasSubstanceUse:h,hasSevereMedCond:u,hasEdVisits:g,hasPsychHospital:p,hasDME:f,patientId:j}=e,[b,N]=(0,_.useState)({notes:!0,additionalInfo:!1,overview:!0}),y=e=>{let t=document.querySelector("#".concat(e));t&&t.scrollIntoView({behavior:"smooth",block:"start"})};return(0,v.jsx)("nav",{className:"sticky top-4 bg-white rounded-lg shadow-md p-4 mb-6 max-h-[calc(100vh-2rem)] overflow-y-auto",children:(0,v.jsxs)("div",{className:"space-y-4",children:[(o||l)&&(0,v.jsxs)("div",{className:"border-b pb-3",children:[(0,v.jsx)("h4",{className:"text-sm font-semibold text-gray-800 mb-2 px-2",children:"Overview"}),(0,v.jsxs)("div",{className:"space-y-1",children:[o&&(0,v.jsxs)("button",{onClick:()=>n("admission"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                            ".concat("admission"===s?"bg-yellow-50 text-yellow-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-yellow-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"Reason for Admission"})]}),l&&(0,v.jsxs)("button",{onClick:()=>n("one-liner"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                            ".concat("one-liner"===s?"bg-blue-50 text-blue-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-blue-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"One Liner"})]})]})]}),(0,v.jsxs)("div",{className:"border-b pb-3",children:[(0,v.jsx)("h4",{className:"text-sm font-semibold text-gray-800 mb-2 px-2",children:"High Priority"}),(0,v.jsxs)("div",{className:"space-y-1",children:[f&&(0,v.jsxs)("button",{onClick:()=>n("diagnostics"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                    ".concat("diagnostics"===s?"bg-purple-50 text-purple-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-purple-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"Diagnostics"})]}),c&&(0,v.jsxs)("button",{onClick:()=>n("discharge"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                    ".concat("discharge"===s?"bg-green-50 text-green-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-green-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"Discharge"})]})]})]}),(0,v.jsxs)("div",{className:"border-b pb-3",children:[(0,v.jsx)("h4",{className:"text-sm font-semibold text-gray-800 mb-2 px-2",children:"Social Needs Assessment"}),(0,v.jsxs)("div",{className:"space-y-1",children:[(0,v.jsxs)("button",{onClick:()=>n("identified-needs"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                ".concat("identified-needs"===s?"bg-blue-50 text-blue-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-blue-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"Identified Needs"})]}),h&&(0,v.jsxs)("button",{onClick:()=>n("substance-use"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                    ".concat("substance-use"===s?"bg-amber-50 text-amber-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-amber-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"Substance Use"})]}),i&&(0,v.jsxs)("button",{onClick:()=>n("housing"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                    ".concat("housing"===s?"bg-green-50 text-green-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-green-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"Housing"})]})]})]}),(0,v.jsxs)("div",{className:"border-b pb-3",children:[(0,v.jsx)("h4",{className:"text-sm font-semibold text-gray-800 mb-2 px-2",children:"Medical Assessment"}),(0,v.jsx)("div",{className:"space-y-1",children:u&&(0,v.jsxs)("button",{onClick:()=>n("severe-med-cond"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                    ".concat("severe-med-cond"===s?"bg-red-50 text-red-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-red-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"Medical Conditions"})]})})]}),(0,v.jsxs)("div",{className:"border-b pb-3",children:[(0,v.jsx)("h4",{className:"text-sm font-semibold text-gray-800 mb-2 px-2",children:"Resources"}),(0,v.jsxs)("div",{className:"space-y-1",children:[m&&(0,v.jsxs)("button",{onClick:()=>n("patient-contacts"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                    ".concat("patient-contacts"===s?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-indigo-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"Patient Contacts"})]}),j&&"782314"!==j&&(0,v.jsxs)("button",{onClick:()=>n("prefilled-forms"),className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md transition-colors duration-200\n                                ".concat("prefilled-forms"===s?"bg-purple-50 text-purple-700 font-medium":"text-gray-900 hover:bg-gray-50"),children:[(0,v.jsx)("span",{className:"w-4 h-4 mr-2 flex-shrink-0 rounded-full bg-purple-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-2.5 h-2.5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,v.jsx)("span",{className:"truncate text-sm",children:"Prefilled Forms"})]})]})]}),(0,v.jsx)("div",{children:(0,v.jsxs)("button",{onClick:()=>{y("patient-notes")},className:"w-full flex items-center justify-start text-left px-2 py-1 rounded-md hover:bg-gray-50 transition-colors duration-200",children:[(0,v.jsx)("span",{className:"w-5 h-5 mr-2 flex-shrink-0 rounded-full bg-gray-100 flex items-center justify-center",children:(0,v.jsx)("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,v.jsx)("span",{className:"font-medium text-gray-900",children:"Patient Notes"})]})})]})})};function z(e){let{summary:t,onNoteClick:s,summaryRef:n,patientId:i}=e,[a,r]=(0,_.useState)(null),[o,l]=(0,_.useState)({}),[c,d]=(0,_.useState)(!1),[m,x]=(0,_.useState)(!1),[h,u]=(0,_.useState)(!1),[g,p]=(0,_.useState)(!1),[f,j]=(0,_.useState)(!1),[b,N]=(0,_.useState)(!1),[y,w]=(0,_.useState)(!1),[k,S]=(0,_.useState)(!1),[C,E]=(0,_.useState)(!1),[I,T]=(0,_.useState)(!1),[B,z]=(0,_.useState)(!1),[F,q]=(0,_.useState)(!1),[G,Z]=(0,_.useState)(!1),[J,Y]=(0,_.useState)(!1),[K,X]=(0,_.useState)({});(0,_.useEffect)(()=>{l(t.identified_needs.reduce((e,t,s)=>(e[s]=!1,e),{}))},[t.identified_needs]);let $=e=>{l(t=>({...t,[e]:!t[e]})),d(Object.values({...o,[e]:!o[e]}).every(e=>e))},Q=e=>{X(t=>({...t,[e]:!t[e]}))};return(0,_.useEffect)(()=>{let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&r(e.target.getAttribute("data-section-id"))})},{threshold:.5});return document.querySelectorAll("[data-note-id]").forEach(t=>e.observe(t)),()=>e.disconnect()},[t]),(0,v.jsxs)("div",{className:"flex gap-6",children:[(0,v.jsx)("div",{className:"w-1/4",children:(0,v.jsx)(D,{needs:t.identified_needs,activeNeedId:a,onNeedClick:e=>{r(e);let t="";"identified-needs"===e?t="#identified-needs-section":"consult"===e?t='[data-section-id="consult"]':"housing"===e?t='[data-section-id="housing"]':"therapy"===e?t='[data-section-id="therapy"]':"admission"===e?t='[data-section-id="admission"]':"one-liner"===e?t='[data-section-id="one-liner"]':"discharge"===e?t='[data-section-id="discharge"]':"support-at-home"===e?t='[data-section-id="support-at-home"]':"patient-notes"===e?t="#patient-notes":"patient-contacts"===e?t='[data-section-id="patient-contacts"]':"substance-use"===e?t='[data-section-id="substance-use"]':"severe-med-cond"===e?t='[data-section-id="severe-med-cond"]':"ed-visits"===e?t='[data-section-id="ed-visits"]':"psych-hospital"===e?t='[data-section-id="psych-hospital"]':"diagnostics"===e?t='[data-section-id="diagnostics"]':"prefilled-forms"===e?t='[data-section-id="prefilled-forms"]':e.startsWith("need-")&&(t='[data-section-id="'.concat(e,'"]'));let s=document.querySelector(t);s&&s.scrollIntoView({behavior:"smooth",block:"start"})},hasHousing:!!t.housing_situation,hasConsult:!!t.reason_for_consult,hasTherapy:t.therapy&&t.therapy.length>0,hasReason:!!t.reason_for_admission,hasOneLiner:!!t.one_liner,hasDischarge:!!t.discharge,hasDx:!1,hasContacts:t.patient_contacts.length>0,hasSupportAtHome:!!t.support_at_home,hasSubstanceUse:!!t.substance_use,hasSevereMedCond:t.severe_med_cond&&t.severe_med_cond.length>0,hasEdVisits:!!t.ed_visits,hasPsychHospital:!!t.psych_hospital,hasDME:!!t.dme&&t.dme.length>0,patientId:i})}),(0,v.jsx)("div",{className:"flex-1 space-y-8",children:(0,v.jsxs)("div",{id:"generated-summary",ref:n,children:[(0,v.jsxs)("div",{className:"mb-12",children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8 border-b-2 border-gray-200 pb-4",children:"Patient Timeline"}),(0,v.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,v.jsx)(L(),{src:"/images/patient_1_timeline.png",alt:"Patient ".concat(i," Timeline"),width:600,height:300,className:"w-1/2 h-auto rounded-lg border border-gray-200 mx-auto"})})]}),(t.reason_for_admission||t.one_liner)&&(0,v.jsxs)("div",{className:"mb-12",children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8 border-b-2 border-gray-200 pb-4",children:"Overview"}),t.reason_for_admission&&(0,v.jsxs)("div",{className:"mb-8","data-section-id":"admission",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Reason for Admission"}),(0,v.jsx)(H,{admission:t.reason_for_admission,onNoteClick:s,isExpanded:f,onToggleExpand:()=>j(!f)})]}),t.one_liner&&(0,v.jsxs)("div",{className:"mb-8","data-section-id":"one-liner",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"One Liner"}),(0,v.jsx)(R,{oneLiner:t.one_liner,onNoteClick:s,isExpanded:b,onToggleExpand:()=>N(!b)})]})]}),(0,v.jsxs)("div",{className:"mb-12",children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8 border-b-2 border-gray-200 pb-4",children:"High Priority"}),t.dme&&t.dme.length>0&&(0,v.jsxs)("div",{className:"mb-8","data-section-id":"diagnostics",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Diagnostics"}),(0,v.jsx)("div",{className:"space-y-4",children:t.dme.map((e,t)=>(0,v.jsx)(W,{device:e,index:t,onNoteClick:s,isExpanded:K[t]||!1,onToggleExpand:()=>Q(t)},t))})]}),t.discharge&&(0,v.jsxs)("div",{className:"mb-8","data-section-id":"discharge",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Discharge"}),(0,v.jsx)(A,{discharge:t.discharge,onNoteClick:s,isExpanded:y,onToggleExpand:()=>w(!y)})]})]}),(0,v.jsxs)("div",{className:"mb-12",children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8 border-b-2 border-gray-200 pb-4",children:"Social Needs Assessment"}),(0,v.jsxs)("div",{className:"mb-8",id:"identified-needs-section",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Identified Needs"}),(0,v.jsxs)("button",{onClick:()=>{let e=!c;d(e),l(Object.keys(o).reduce((t,s)=>(t[Number(s)]=e,t),{})),x(e),u(e),p(e),j(e),N(e),w(e),S(e),E(e),T(e),z(e),q(e),Z(e),Y(e)},className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",children:[(0,v.jsx)("svg",{className:"w-5 h-5 mr-2 transition-transform duration-200 ".concat(c?"transform rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),c?"Collapse All":"Expand All"]})]}),t.identified_needs.map((e,t)=>(0,v.jsx)(M,{need:e,index:t,onNoteClick:s,isExpanded:o[t]||!1,onToggleExpand:()=>$(t)},t))]}),t.substance_use&&(0,v.jsxs)("div",{className:"mb-8","data-section-id":"substance-use",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Substance Use"}),(0,v.jsx)(U,{substanceUse:t.substance_use,onNoteClick:s,isExpanded:I,onToggleExpand:()=>T(!I)})]}),t.housing_situation&&(0,v.jsxs)("div",{className:"mb-8","data-section-id":"housing",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Housing"}),(0,v.jsx)(O.r,{housing:t.housing_situation,onNoteClick:s,isExpanded:m,onToggleExpand:()=>x(!m)})]})]}),(0,v.jsxs)("div",{className:"mb-12",children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8 border-b-2 border-gray-200 pb-4",children:"Medical Assessment"}),t.severe_med_cond&&t.severe_med_cond.length>0&&(0,v.jsx)(V,{conditions:t.severe_med_cond,onNoteClick:s})]}),(0,v.jsxs)("div",{className:"mb-12",children:[(0,v.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8 border-b-2 border-gray-200 pb-4",children:"Resources"}),t.patient_contacts.length>0&&(0,v.jsx)("div",{className:"mb-8","data-section-id":"patient-contacts",children:(0,v.jsx)(P,{contacts:t.patient_contacts,onNoteClick:s,isExpanded:k,onToggleExpand:()=>S(!k)})}),i&&"782314"!==i&&(0,v.jsxs)("div",{className:"mb-8","data-section-id":"prefilled-forms",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Prefilled Forms"}),(0,v.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"IHSS Form"}),(0,v.jsx)("p",{className:"text-gray-600",children:"View prefilled IHSS form with supporting citations or download PDF"})]}),(0,v.jsx)("div",{className:"flex gap-3",children:(0,v.jsxs)("button",{onClick:()=>{window.open("/ihss.pdf","_blank")},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 flex items-center",children:[(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,v.jsx)("path",{fillRule:"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z",clipRule:"evenodd"})}),"Download PDF"]})})]})})]})]})]})})]})}var F=s(3596);function q(){let{id:e,timestamp:t}=(0,y.useRouter)().query,[s,n]=(0,_.useState)(!0),[i,a]=(0,_.useState)(null),[r,o]=(0,_.useState)([]),[l,c]=(0,_.useState)(null),[d,m]=(0,_.useState)(null),[x,h]=(0,_.useState)(null),[u,g]=(0,_.useState)(!1),f=(0,_.useRef)(null),[b,w]=(0,_.useState)(null);return((0,_.useEffect)(()=>{let e=()=>{f.current&&g(f.current.getBoundingClientRect().bottom<0)};return window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]),(0,_.useEffect)(()=>{e&&(async()=>{n(!0);try{console.log("Loading data from static JSON...");let t=await fetch("/hospital-flow/patient_discharge.json");if(!t.ok)throw Error("Failed to load static data");let s=await t.json();console.log("Static data loaded successfully:",s);let n=s.find(t=>t.pat_id_surrogate.toString()===e);if(n){let e=function(e){var t,s,n,i,a,r,o,l;let c=e=>"string"==typeof e?{note_id:1,quote:e}:{note_id:e.note_id,quote:e.quote},d=e.summary,m=[];if(d.social_needs_assessment){let e=d.social_needs_assessment;e.mental_health&&m.push({social_need_type:j.MENTAL_HEALTH,description:e.mental_health.summary,citation:c(e.mental_health.evidence),previous_actions:[],current_actions:[],planned_actions:[]}),e.transportation&&m.push({social_need_type:j.HOUSING,description:"Transportation",citation:e.transportation.evidence,previous_actions:[],current_actions:[{description:e.transportation.summary,citation:c(e.transportation.evidence),resources:[]}],planned_actions:[]}),e.safety&&m.push({social_need_type:j.HOUSING,description:"Safety: ".concat(e.safety.summary),citation:c(e.safety.evidence),previous_actions:[],current_actions:[],planned_actions:[]}),e.food_insecurity&&m.push({social_need_type:j.FOOD_INSECURITY,description:e.food_insecurity.summary,citation:c(e.food_insecurity.evidence),previous_actions:[],current_actions:[],planned_actions:[]}),e.tobacco_use&&m.push({social_need_type:j.TOBACCO_USE,description:e.tobacco_use.summary,citation:c(e.tobacco_use.evidence),previous_actions:[],current_actions:[],planned_actions:[]}),e.alcohol_use&&m.push({social_need_type:j.ALOCHOL_USE,description:e.alcohol_use.summary,citation:c(e.alcohol_use.evidence),previous_actions:[],current_actions:[],planned_actions:[]})}return{identified_needs:m,housing_situation:(null===(t=d.social_needs_assessment)||void 0===t?void 0:t.housing)?{summary:d.social_needs_assessment.housing.summary,citations:[c(d.social_needs_assessment.housing.evidence)]}:void 0,reason_for_admission:d.reason_for_admission?{reason:d.reason_for_admission.summary,citation:c(d.reason_for_admission.evidence)}:void 0,one_liner:d.one_liner?{summary:d.one_liner.summary,citation:c(d.one_liner.evidence)}:void 0,discharge:(null===(s=d.high_priority)||void 0===s?void 0:s.discharge)?{summary:d.high_priority.discharge.summary,details:d.high_priority.discharge.details,link_to_prefilled_ihss_form:d.high_priority.discharge.link_to_prefilled_ihss_form,citation:c(d.high_priority.discharge.evidence)}:void 0,dx_for_encounter:void 0,therapy:[],patient_contacts:(null===(i=d.resources)||void 0===i?void 0:null===(n=i.patient_contacts)||void 0===n?void 0:n.map(e=>({name:e.name,relation:e.relation,contact_info:e.contact_info,citation:c(e.evidence)})))||[],support_at_home:(null===(a=d.high_priority)||void 0===a?void 0:a.discharge)?{summary:d.high_priority.discharge.summary,citation:c(d.high_priority.discharge.evidence)}:void 0,substance_use:(null===(r=d.social_needs_assessment)||void 0===r?void 0:r.substance_use)?{status:p.NO_USE,summary:d.social_needs_assessment.substance_use.summary,citation:c(d.social_needs_assessment.substance_use.evidence)}:void 0,severe_med_cond:(null===(o=d.medical_assessment)||void 0===o?void 0:o.severe_medical_conditions)?[{diagnosis:d.medical_assessment.severe_medical_conditions.summary,citation:c(d.medical_assessment.severe_medical_conditions.evidence)}]:[],ed_visits:void 0,psych_hospital:void 0,dme:(null===(l=d.high_priority)||void 0===l?void 0:l.diagnostics)?Object.entries(d.high_priority.diagnostics).map(e=>{let[t,s]=e;return{device_type:t.replace(/_/g," ").toUpperCase(),summary:s.summary,citation:c(s.evidence)}}):[]}}(n);a(e);let t=n.notes.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime());console.log("Notes loaded:",t),o(t)}else throw Error("No data found for patient ID ".concat(e))}catch(e){console.error("Error loading data:",e),c(e instanceof Error?e.message:"An error occurred loading patient data")}finally{n(!1)}})()},[e]),(0,_.useEffect)(()=>{if(d&&r.length>0){let e=setTimeout(()=>{let e=document.querySelector('[data-note-id="'.concat(d,'"]'));if(e){console.log("\uD83D\uDCCD Scrolling to highlighted note:",d);let t=e.getBoundingClientRect(),s=window.pageYOffset+t.top-window.innerHeight/2+t.height/2;window.scrollTo({top:s,behavior:"smooth"})}},150);return()=>clearTimeout(e)}},[d,r.length]),s)?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(N(),{children:(0,v.jsx)("title",{children:"Loading... | Social Services Note Viewer"})}),(0,v.jsx)(S.Z,{})]}):l?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(N(),{children:(0,v.jsx)("title",{children:"Error | Social Services Note Viewer"})}),(0,v.jsxs)("div",{className:"flex h-screen",children:[(0,v.jsx)(C.Z,{currentPatientId:e}),(0,v.jsx)("div",{className:"flex-1 overflow-auto",children:(0,v.jsx)("div",{className:"max-w-7xl mx-auto p-4",children:(0,v.jsx)("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded",children:(0,v.jsx)("p",{children:l})})})})]})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(N(),{children:[(0,v.jsxs)("title",{children:["Patient ",e," Summary | Social Services Note Viewer"]}),(0,v.jsx)("meta",{name:"description",content:"View and analyze social services notes and summaries"})]}),(0,v.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,v.jsx)(F.Z,{}),(0,v.jsxs)("div",{className:"flex flex-1",children:[(0,v.jsx)(C.Z,{currentPatientId:e}),(0,v.jsx)("div",{className:"flex-1 overflow-auto",children:(0,v.jsxs)("div",{className:"max-w-7xl mx-auto p-4",children:[(0,v.jsxs)("div",{className:"flex flex-col space-y-12",children:[(0,v.jsx)("section",{id:"generated-summary",className:"scroll-mt-4",children:i?(0,v.jsx)(z,{summary:i,onNoteClick:(e,t,s)=>{let n=e.toString();console.log("handleNoteClick called:",{noteId:e,noteIdStr:n,sectionId:t,quote:s}),m(n),h(s||null),w(t||null)},summaryRef:f,patientId:e}):(0,v.jsx)("div",{className:"bg-yellow-50 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:"No summary available"})}),(0,v.jsxs)("section",{id:"patient-notes",className:"scroll-mt-4",children:[(0,v.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Patient Notes"}),(0,v.jsx)("div",{className:"space-y-6",children:r.map(e=>(0,v.jsx)(k,{note:e,isHighlighted:d===e.note_id.toString(),highlightedQuote:d===e.note_id.toString()&&x||void 0},"".concat(e.timestamp,"-").concat(d,"-").concat(x?"h":"n")))})]})]}),u&&(0,v.jsxs)("button",{onClick:()=>{var e,t;b?(null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{let e=document.querySelector('[data-section-id="'.concat(b,'"]'));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("bg-blue-50"),setTimeout(()=>{e.classList.remove("bg-blue-50")},2e3))},100)):null===(t=f.current)||void 0===t||t.scrollIntoView({behavior:"smooth",block:"start"})},className:"fixed bottom-6 right-6 bg-blue-600 text-white px-4 py-2 rounded-full shadow-lg hover:bg-blue-700 transition-colors duration-200 flex items-center space-x-2 z-50 group","aria-label":"Back to summary",children:[(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,v.jsx)("path",{fillRule:"evenodd",d:"M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),(0,v.jsxs)("span",{children:["Back to"," ",(0,v.jsx)("span",{className:"font-medium",children:b?"Last Section":"Summary"})]})]})]})})]})]})]})}}},function(e){e.O(0,[814,675,888,774,179],function(){return e(e.s=2779)}),_N_E=e.O()}]);