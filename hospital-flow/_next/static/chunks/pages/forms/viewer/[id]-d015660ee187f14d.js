(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{5707:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/forms/viewer/[id]",function(){return i(8977)}])},2600:function(e,t,i){"use strict";i.d(t,{I:function(){return l}});var s=i(5893);function l(e){let{citation:t,sectionId:i,onNoteClick:l}=e;return(0,s.jsxs)("blockquote",{className:"border-l-4 border-blue-500 pl-4 italic cursor-pointer bg-white rounded-r-lg transition-all duration-200 hover:shadow-md mt-4",onClick:()=>{console.log("Citation clicked:",{noteId:t.note_id,sectionId:i,quote:t.quote}),null==l||l(t.note_id,i,t.quote)},children:[(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["“",t.quote,"”"]}),(0,s.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[(0,s.jsx)("span",{className:"font-medium",children:"Source:"})," Note ",t.note_id]})]})}},2266:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var s=i(5893);i(7294);var l=i(1163);let r=[{id:1,name:"Patient 1"},{id:2,name:"Patient 2"},{id:3,name:"Patient 3"},{id:4,name:"Patient 4"}];var n=()=>{let e=(0,l.useRouter)();return(0,s.jsxs)("div",{className:"w-64 min-h-screen bg-gradient-to-b from-blue-600 to-blue-700 shadow-lg",children:[(0,s.jsx)("button",{onClick:()=>e.push("/"),className:"w-full p-4 border-b border-blue-500 text-left hover:bg-blue-500/20 transition-colors",children:(0,s.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Patient Records"})}),(0,s.jsx)("nav",{className:"p-4",children:(0,s.jsx)("ul",{className:"space-y-2",children:r.map(t=>(0,s.jsx)("li",{children:(0,s.jsxs)("button",{onClick:()=>e.push("/patient/".concat(t.id)),className:"w-full text-left px-4 py-3 rounded bg-white/10 hover:bg-white/20 transition-all transform hover:scale-[1.02]",children:[(0,s.jsx)("div",{className:"font-medium text-white",children:t.name}),(0,s.jsxs)("div",{className:"text-sm text-blue-100",children:["ID: ",t.id]})]})},t.id))})})]})};function a(e){let{children:t,showSidebar:i=!1}=e;return(0,s.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,s.jsxs)("div",{className:"flex",children:[i&&(0,s.jsx)(n,{}),(0,s.jsx)("main",{className:"min-h-screen ".concat(i?"flex-1 p-8":"w-full"),children:t})]})})}},117:function(e,t,i){"use strict";var s=i(5893);i(7294),t.Z=()=>(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-100 bg-opacity-75 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("h2",{className:"mt-4 text-xl font-semibold text-gray-700",children:"Generating Summary..."}),(0,s.jsx)("p",{className:"mt-2 text-gray-500",children:"Please wait while we analyze the patient notes."})]})})},8977:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return x}});var s=i(5893),l=i(9008),r=i.n(l),n=i(1163),a=i(7294),d=i(2266),o=i(117),c=i(2600);function x(){var e,t,i,l;let x=(0,n.useRouter)(),{id:m,timestamp:h}=x.query,[u,f]=(0,a.useState)(!0),[j,b]=(0,a.useState)(null),[g,v]=(0,a.useState)([]),[p,w]=(0,a.useState)(null),[N,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{m&&h&&(async()=>{f(!0);try{let e=await fetch("/api/forms/data/".concat(m,"?timestamp=").concat(h));if(!e.ok)throw Error("Failed to fetch form data");let t=await e.json();b(t);let i=await fetch("http://127.0.0.1:5000/patients/".concat(m,"/summary?timestamp=").concat(h));if(!i.ok)throw Error("Failed to fetch notes");let s=await i.json();v(s.notes)}catch(e){console.error("Error fetching form data:",e),w(e instanceof Error?e.message:"An error occurred")}finally{f(!1)}})()},[m,h]);let _=e=>{y(e)};return u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r(),{children:(0,s.jsx)("title",{children:"Loading Form Viewer... | Social Services Note Viewer"})}),(0,s.jsx)(o.Z,{})]}):p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r(),{children:(0,s.jsx)("title",{children:"Error | Social Services Note Viewer"})}),(0,s.jsx)(d.Z,{showSidebar:!1,children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto p-4",children:(0,s.jsxs)("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{children:p}),(0,s.jsx)("button",{onClick:()=>x.back(),className:"mt-2 text-sm font-medium text-red-600 hover:text-red-500",children:"Go Back"})]})})})]}):j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r(),{children:[(0,s.jsxs)("title",{children:["Form Viewer - Patient ",m," | Social Services Note Viewer"]}),(0,s.jsx)("meta",{name:"description",content:"View prefilled form with citations"})]}),(0,s.jsx)(d.Z,{showSidebar:!1,children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:[j.name," - Patient ",m]}),(0,s.jsxs)("button",{onClick:()=>x.back(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200 flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L4.414 9H17a1 1 0 110 2H4.414l5.293 5.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to Patient Summary"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"bg-green-50 border-b border-green-200 px-6 py-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-green-800",children:"Prefilled Form Fields"}),(0,s.jsx)("p",{className:"text-sm text-green-600",children:"Click on fields to see supporting citations"})]}),(0,s.jsx)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:(0,s.jsx)("div",{className:"space-y-4",children:null===(e=j.filled_fields)||void 0===e?void 0:e.map(e=>{var t,i;return(0,s.jsx)("div",{onClick:()=>_(e),className:"p-4 border rounded-lg cursor-pointer transition-all ".concat((null==N?void 0:N.field_id)===e.field_id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 mb-1",children:(null===(t=j.fields.find(t=>t.field_id===e.field_id))||void 0===t?void 0:t.name)||e.field_id}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:null===(i=j.fields.find(t=>t.field_id===e.field_id))||void 0===i?void 0:i.question}),(0,s.jsxs)("div",{className:"bg-gray-100 p-2 rounded text-sm",children:[(0,s.jsx)("strong",{children:"Value:"})," ",e.value||"No value provided"]})]}),e.citation&&(0,s.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Citation Available"})})]})},e.field_id)})})})]}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"bg-blue-50 border-b border-blue-200 px-6 py-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-blue-800",children:"Supporting Evidence"}),(0,s.jsx)("p",{className:"text-sm text-blue-600",children:N?"Citation for: ".concat((null===(t=j.fields.find(e=>e.field_id===N.field_id))||void 0===t?void 0:t.name)||N.field_id):"Select a field to view its supporting citation"})]}),(0,s.jsx)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:(null==N?void 0:N.citation)?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"font-medium text-yellow-800 mb-2",children:"Field Information"}),(0,s.jsxs)("p",{className:"text-sm text-yellow-700 mb-2",children:[(0,s.jsx)("strong",{children:"Field:"})," ",null===(i=j.fields.find(e=>e.field_id===N.field_id))||void 0===i?void 0:i.name]}),(0,s.jsxs)("p",{className:"text-sm text-yellow-700 mb-2",children:[(0,s.jsx)("strong",{children:"Question:"})," ",null===(l=j.fields.find(e=>e.field_id===N.field_id))||void 0===l?void 0:l.question]}),(0,s.jsxs)("p",{className:"text-sm text-yellow-700",children:[(0,s.jsx)("strong",{children:"Answer:"})," ",N.value]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Supporting Citation"}),(0,s.jsx)(c.I,{citation:N.citation,sectionId:"form-field-".concat(N.field_id),onNoteClick:(e,t,i)=>{console.log("Note clicked:",e,i)}})]})]}):N?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Citation Available"}),(0,s.jsx)("p",{className:"text-gray-600",children:"This field does not have a supporting citation from the patient notes."})]}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Field"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Click on a form field to view its supporting citation and evidence from the patient notes."})]})})]})]})]})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r(),{children:(0,s.jsx)("title",{children:"Form Not Found | Social Services Note Viewer"})}),(0,s.jsx)(d.Z,{showSidebar:!1,children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto p-4",children:(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:(0,s.jsx)("p",{children:"Form data not found"})})})})]})}},9008:function(e,t,i){e.exports=i(3867)},1163:function(e,t,i){e.exports=i(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=5707)}),_N_E=e.O()}]);